using Base: String, Bool, Complex
# using Core: Matrix, Vector
using LinearAlgebra

include("CHform.jl")
include("GSmat.jl")
include("MetroHast.jl")

function translate(circ::Vector{Vector{String}})
    for i in 1:length(circ[2])
        if circ[1][i] == "CX" || circ[1][i] == "CZ"
            qb = circ[2][i]
            qbidx = findfirst(" ", qb)[1]
            q = parse(Int8,qb[1:qbidx])
            r = parse(Int8,qb[qbidx+1:end])
            circ[2][i] = string(string(q+1), " ", string(r + 1))
        else 
            num = parse(Int8, circ[2][i])
            circ[2][i] = string(num+1)
        end
    end
end

N = 15
circ1 = [["H", "CZ", "S", "CX", "H", "S", "H", "CX", "CX", "CZ", "CX", "H", "CZ", "CZ", "H", "CZ", "H", "H", "H", "CX", "S", "CX", "S", "H", "S", "H", "S", "CZ", "S", "CX", "S", "S", "CZ", "CX", "S", "CX", "S", "CX", "S", "H", "CZ", "S", "CX", "CZ", "CX", "CZ", "CX", "CX", "S", "CZ", "H", "H", "CZ", "CX", "S", "CX", "CZ", "CX", "H", "H", "CZ", "CX", "CZ", "CZ", "CZ", "CX", "CX", "CX", "CZ", "H", "H", "CX", "CX", "H", "S", "S", "S", "CZ", "H", "CZ", "CX", "CZ", "S", "S", "H", "CZ", "CX", "H", "CZ", "H", "H", "H", "CX", "H", "S", "CZ", "H", "S", "S", "CX", "CX", "CZ", "H", "CZ", "H", "S", "CZ", "CZ", "CZ", "S", "CZ", "CZ", "CZ", "H", "H", "S", "CX", "CZ", "CX", "S", "S", "CX", "CZ", "CZ", "S", "H", "CZ", "H", "H", "S", "H", "CZ", "CX", "CX", "S", "H", "CX", "CX", "CZ", "CX", "CZ", "CX", "S", "S", "S", "CZ", "CZ", "CX", "CZ", "H", "S", "CZ", "H", "S", "S", "S", "S", "H", "S", "H", "CZ", "S", "CX", "CZ", "H", "CX", "H", "H", "CZ", "S", "H", "CX", "S", "CZ", "H", "S", "CZ", "CX", "CZ", "S", "CZ", "CZ", "S", "S", "H", "H", "S", "CZ", "CX", "H", "CX", "CX", "S", "CX", "H", "CZ", "S", "CZ", "S", "S", "H", "CX", "S", "S", "CX", "CX", "H", "S", "S", "S", "CX", "CZ", "CX", "CX", "CX", "S", "CZ", "H", "CZ", "S", "H", "S", "CX", "S", "H", "H", "CX", "CX", "S", "CX", "CZ", "CX", "S", "H", "CZ", "CX", "S", "CZ", "CX", "H", "CX", "S", "CX", "CZ", "CX", "CZ", "S", "CX", "CX", "CZ", "CZ", "H", "CX", "S", "H", "S", "CZ", "S", "CZ", "CX", "CZ", "CZ", "CX", "CZ", "H", "CZ", "CZ", "S", "S", "CZ", "H", "S", "CX", "S", "CZ", "S", "S", "CX", "H", "S", "S", "H", "CX", "CX", "H", "CZ", "CX", "H", "CX", "H", "S", "H", "CZ", "CX", "S", "S", "S", "CZ", "S", "CX", "CX", "S", "CZ", "S", "H", "CX", "H", "CZ", "CZ", "S", "CZ", "CZ", "CX", "CX", "S", "H", "CZ", "H", "CX", "H", "CX", "S", "H", "S", "S", "CZ", "S", "H", "H", "H", "CZ", "H", "CZ", "H", "CX", "CZ", "S", "CX", "CX", "CZ", "CZ", "H", "CX", "H", "CZ", "H", "S", "CZ", "H", "CX", "CZ", "H", "CX", "H", "CX", "S", "CZ", "H", "H", "CX", "CX", "CX", "CZ", "H", "CZ", "CZ", "H", "CX", "S", "S", "CZ", "H", "CZ", "S", "CX", "S", "S", "S", "S", "CX", "CZ", "S", "H", "H", "CX", "H", "CZ", "S", "CX", "S", "CZ", "CZ", "CX", "CZ", "CX", "S", "S", "H", "H", "H", "CZ", "CX", "CX", "CX", "H", "CX", "S", "H", "CX", "S", "CZ", "CX", "S", "S", "S", "S", "CZ", "H", "CZ", "CX", "CX", "CX", "H", "S", "CX", "CX", "CX", "CX", "H", "S", "H", "H", "CX", "S", "CX", "H", "H", "H", "S", "H", "S", "H", "CZ", "H", "S", "CX", "CX", "H", "S", "S", "S", "S", "H", "S", "H", "CZ", "CZ", "H", "CX", "CX", "H", "S", "CZ", "H", "CX", "H", "S", "CX", "S", "H", "S", "CZ", "CZ", "CZ", "CZ", "CZ", "CZ", "CX", "CX", "CZ", "H", "CZ", "CZ", "S", "H", "H", "H", "S", "CX", "CX", "S", "S", "CX", "H", "H", "CZ", "CZ", "CX", "CX", "CX"], ["7", "8 9", "6", "6 5", "2", "0", "10", "1 12", "0 7", "13 2", "5 3", "10", "7 8", "9 4", "6", "2 4", "4", "13", "14", "10 11", "5", "4 7", "5", "11", "2", "8", "10", "13 2", "0", "8 13", "12", "12", "11 14", "14 7", "9", "1 8", "10", "14 8", "10", "9", "3 12", "10", "9 11", "1 12", "8 7", "4 5", "13 2", "1 13", "2", "9 14", "3", "11", "13 5", "1 14", "6", "9 10", "4 7", "5 9", "3", "14", "12 9", "9 5", "13 1", "14 7", "10 5", "4 6", "2 11", "13 7", "7 1", "4", "4", "2 13", "9 12", "8", "7", "6", "3", "8 3", "0", "12 14", "2 12", "12 5", "11", "8", "4", "1 3", "10 0", "3", "2 6", "12", "11", "13", "6 4", "11", "1", "13 3", "2", "10", "14", "9 12", "10 12", "10 12", "3", "2 3", "11", "6", "7 1", "11 13", "1 10", "0", "12 11", "0 2", "4 12", "2", "11", "12", "4 9", "8 4", "2 0", "12", "4", "10 14", "11 3", "4 13", "1", "5", "13 10", "10", "10", "9", "11", "10 6", "1 7", "14 12", "2", "4", "4 6", "14 13", "6 1", "11 1", "14 10", "4 6", "11", "5", "6", "14 3", "14 10", "2 4", "0 12", "1", "14", "9 8", "0", "9", "5", "13", "12", "2", "10", "6", "14 7", "14", "6 12", "7 5", "2", "4 3", "13", "3", "5 10", "8", "11", "3 8", "11", "10 7", "14", "8", "5 10", "4 13", "2 8", "5", "2 1", "7 2", "1", "10", "0", "1", "11", "0 12", "1 6", "9", "13 0", "8 5", "14", "14 6", "3", "9 4", "13", "11 6", "12", "4", "12", "0 11", "6", "10", "11 0", "1 12", "9", "8", "10", "14", "13 2", "13 0", "7 13", "1 6", "3 10", "5", "2 13", "4", "13 12", "4", "14", "5", "12 5", "6", "2", "7", "9 5", "1 11", "14", "4 14", "11 10", "6 0", "6", "7", "4 13", "0 4", "6", "10 7", "6 3", "4", "12 7", "9", "3 11", "12 4", "7 1", "11 12", "9", "1 5", "14 2", "14 2", "12 7", "12", "13 7", "3", "9", "0", "7 10", "0", "9 7", "11 3", "10 9", "7 10", "6 5", "1 0", "9", "10 5", "14 3", "10", "9", "7 2", "7", "5", "12 7", "8", "11 3", "10", "1", "2 8", "7", "14", "2", "3", "14 11", "8 7", "4", "0 2", "2 6", "4", "4 2", "11", "10", "5", "10 1", "14 3", "11", "13", "12", "3 4", "1", "0 6", "2 12", "6", "14 10", "1", "2", "2 5", "11", "1 10", "12 14", "6", "3 0", "0 1", "12 13", "7 10", "8", "6", "3 14", "5", "0 6", "10", "6 4", "8", "13", "4", "9", "0 2", "0", "0", "1", "13", "2 9", "6", "3 7", "2", "13 2", "1 0", "4", "9 3", "6 1", "14 8", "13 4", "12", "6 11", "11", "3 12", "9", "14", "6 5", "0", "0 2", "11 2", "1", "6 3", "14", "12 7", "7", "12 7", "10", "6", "11 1", "5 0", "2 0", "5 4", "2", "4 12", "0 3", "9", "9 12", "0", "13", "6 11", "10", "13 2", "14", "2 14", "10", "10", "3", "12", "4 5", "0 3", "8", "5", "1", "6 2", "7", "9 5", "7", "10 2", "0", "8 10", "7 6", "3 12", "7 11", "8 12", "8", "3", "10", "1", "13", "1 7", "9 1", "8 13", "7 4", "1", "5 6", "2", "9", "8 6", "12", "11 13", "12 4", "0", "2", "0", "9", "8 0", "7", "8 5", "0 14", "5 7", "6 0", "5", "9", "4 10", "6 1", "3 10", "6 3", "9", "8", "5", "10", "12 5", "2", "7 11", "12", "12", "8", "2", "9", "5", "10", "2 6", "8", "13", "9 0", "5 4", "13", "3", "3", "7", "12", "10", "0", "13", "10 3", "4 0", "3", "2 8", "14 5", "5", "7", "3 2", "4", "8 4", "4", "6", "9 10", "0", "3", "9", "2 6", "14 11", "10 4", "2 3", "3 9", "9 12", "11 8", "13 1", "8 13", "8", "5 11", "4 14", "2", "12", "14", "7", "7", "14 10", "12 11", "10", "4", "3 10", "2", "14", "5 3", "8 13", "2 10", "8 11", "10 11"]]
circ2 = [["H", "CX", "S", "H", "CZ", "CZ", "H", "S", "CZ", "S", "CX", "S", "CX", "S", "CX", "H", "CX", "H", "CX", "CZ", "CZ", "CX", "H", "S", "H", "H", "CX", "CX", "CX", "CX", "CZ", "CZ", "CZ", "H", "CZ", "S", "S", "H", "CZ", "CZ", "H", "CZ", "S", "S", "CX", "CZ", "H", "CZ", "CX", "S", "CX", "CX", "CZ", "CX", "H", "S", "H", "CX", "H", "S", "S", "CX", "H", "CZ", "CZ", "CZ", "CX", "CX", "CX", "CX", "CX", "S", "S", "H", "CZ", "CX", "CZ", "CZ", "CZ", "CX", "H", "CZ", "H", "CX", "H", "CX", "S", "CZ", "CX", "S", "CX", "CX", "CX", "S", "H", "CX", "CX", "CX", "CX", "CX", "S", "CX", "CX", "CX", "H", "H", "S", "S", "S", "S", "CX", "CX", "H", "S", "H", "H", "CX", "S", "S", "S", "CZ", "CZ", "S", "CZ", "H", "H", "CZ", "S", "S", "CZ", "H", "H", "H", "S", "CZ", "CX", "S", "CZ", "H", "CX", "CX", "S", "H", "H", "S", "S", "S", "CX", "H", "CX", "S", "CX", "CX", "S", "CZ", "CX", "CX", "CZ", "CZ", "S", "CX", "CZ", "CZ", "CZ", "S", "S", "H", "S", "S", "CZ", "H", "S", "S", "CZ", "S", "CZ", "CZ", "S", "S", "CZ", "H", "H", "CZ", "CX", "CZ", "CX", "CX", "S", "H", "CX", "S", "CZ", "CZ", "CX", "CX", "CZ", "S", "CZ", "CX", "CX", "CX", "S", "H", "H", "S", "S", "CZ", "CZ", "CX", "CX", "S", "CZ", "CZ", "CZ", "H", "CZ", "CX", "CX", "H", "H", "CZ", "CX", "S", "CX", "S", "H", "CZ", "S", "S", "CZ", "CX", "S", "S", "CZ", "S", "H", "CX", "H", "CZ", "S", "S", "H", "CZ", "CX", "CZ", "CZ", "S", "S", "CZ", "H", "S", "CZ", "CZ", "CX", "CZ", "CZ", "H", "S", "CX", "H", "CX", "S", "CX", "CX", "CZ", "CZ", "CX", "CX", "CZ", "H", "S", "CZ", "CZ", "CZ", "CX", "S", "CX", "CX", "CX", "CZ", "CZ", "CX", "S", "CZ", "H", "S", "S", "H", "S", "H", "CZ", "CX", "CX", "H", "CZ", "H", "S", "H", "H", "S", "CZ", "CZ", "S", "H", "H", "CX", "CX", "S", "CZ", "S", "CX", "CZ", "H", "CZ", "H", "CX", "CZ", "S", "S", "S", "CZ", "CZ", "CZ", "CX", "CZ", "CX", "CZ", "S", "CZ", "CZ", "H", "S", "H", "CZ", "H", "CX", "H", "H", "CZ", "S", "CX", "S", "H", "CX", "S", "S", "H", "S", "S", "H", "S", "CZ", "CX", "CZ", "CX", "H", "CZ", "CZ", "CZ", "S", "CX", "CX", "S", "CZ", "CX", "CZ", "CZ", "S", "CX", "CX", "H", "S", "CX", "CZ", "CX", "CX", "CX", "CZ", "CX", "CX", "CZ", "CZ", "CZ", "S", "H", "S", "CZ", "CZ", "CZ", "CX", "H", "H", "S", "CZ", "S", "CX", "H", "CX", "CZ", "CZ", "CZ", "CX", "S", "H", "CX", "S", "CZ", "S", "CX", "CZ", "H", "S", "CX", "S", "S", "CX", "S", "S", "S", "CZ", "S", "H", "CZ", "CX", "S", "H", "CX", "H", "S", "H", "S", "CX", "H", "CX", "CZ", "CZ", "H", "H", "CZ", "S", "CZ", "S", "CX", "CZ", "H", "CX", "CZ", "CX", "CZ", "H", "H", "CX", "S", "H", "CZ", "CX", "CZ", "CX", "CZ", "S", "S", "CX", "S", "CZ", "H", "CX", "CZ", "S", "CZ", "CZ", "S", "CX", "CZ", "H", "H", "H", "H", "S", "CX", "H", "S", "S", "H", "H", "CX", "CX", "S", "H", "S", "CX", "S", "CZ", "S", "S", "CZ", "S", "S", "CZ", "H", "S"], ["3", "10 8", "5", "8", "3 8", "11 1", "7", "2", "2 6", "5", "0 6", "2", "14 5", "11", "7 2", "14", "7 4", "0", "9 10", "12 7", "6 0", "9 1", "11", "7", "14", "0", "0 12", "1 11", "13 8", "11 7", "2 4", "3 2", "6 5", "7", "0 7", "7", "14", "7", "10 12", "9 13", "6", "10 5", "10", "0", "2 10", "11 13", "11", "12 9", "13 11", "5", "0 10", "2 1", "3 4", "14 1", "2", "12", "9", "4 8", "13", "5", "6", "12 4", "11", "8 9", "9 1", "5 0", "2 6", "0 1", "13 14", "14 5", "8 6", "4", "11", "2", "5 8", "13 7", "10 14", "5 7", "6 13", "9 6", "3", "1 12", "8", "10 0", "3", "7 10", "3", "14 12", "3 14", "10", "14 13", "12 1", "4 5", "8", "12", "12 1", "6 2", "1 7", "1 11", "3 13", "7", "12 4", "12 13", "7 11", "14", "7", "1", "10", "3", "2", "11 2", "8 9", "2", "7", "0", "10", "2 1", "0", "11", "11", "4 9", "7 11", "10", "8 11", "9", "8", "2 4", "9", "1", "13 0", "12", "4", "5", "9", "0 11", "6 0", "11", "2 12", "8", "1 9", "2 5", "9", "8", "3", "0", "2", "1", "5 6", "12", "2 6", "1", "11 14", "9 14", "0", "9 6", "7 2", "11 3", "3 8", "4 13", "4", "7 5", "4 10", "2 8", "1 5", "4", "14", "13", "5", "7", "1 3", "3", "3", "11", "4 7", "3", "9 2", "13 11", "6", "1", "14 9", "1", "7", "4 10", "4 11", "1 12", "14 8", "9 12", "14", "1", "10 11", "10", "6 14", "4 5", "3 13", "5 10", "3 9", "6", "14 3", "11 3", "11 4", "9 13", "13", "7", "4", "6", "5", "14 13", "4 10", "13 0", "10 13", "4", "8 10", "9 1", "14 5", "13", "7 0", "3 10", "0 6", "5", "4", "0 11", "13 7", "6", "12 10", "1", "13", "8 2", "9", "14", "1 10", "2 11", "3", "7", "0 14", "7", "6", "13 6", "7", "1 9", "5", "10", "4", "10 0", "2 11", "3 1", "8 3", "1", "13", "5 6", "11", "4", "4 12", "13 12", "7 11", "2 13", "9 0", "13", "4", "9 0", "14", "3 2", "6", "5 13", "7 10", "2 4", "2 0", "13 7", "14 7", "14 0", "3", "3", "10 1", "5 10", "13 0", "12 13", "14", "11 1", "12 7", "12 2", "8 14", "14 13", "14 3", "4", "1 3", "0", "10", "5", "2", "1", "12", "4 11", "0 7", "14 0", "1", "7 13", "6", "2", "11", "5", "6", "11 10", "10 4", "4", "2", "10", "7 4", "9 11", "13", "3 13", "0", "5 11", "2 3", "9", "8 13", "4", "6 9", "6 3", "9", "11", "12", "4 5", "11 1", "11 8", "14 4", "10 6", "2 3", "1 10", "2", "6 9", "1 9", "5", "5", "5", "13 12", "3", "5 0", "11", "2", "10 3", "6", "11 14", "13", "1", "9 12", "2", "10", "9", "5", "12", "8", "11", "11 1", "1 2", "4 12", "12 8", "13", "13 3", "2 13", "2 5", "11", "6 2", "12 9", "14", "13 1", "12 14", "13 12", "13 10", "12", "3 13", "10 14", "0", "7", "13 1", "8 9", "6 10", "3 8", "12 8", "11 13", "9 3", "5 1", "8 2", "13 8", "4 2", "2", "1", "6", "9 1", "10 0", "10 2", "11 1", "5", "10", "14", "8 12", "5", "13 10", "6", "1 8", "0 9", "8 9", "11 5", "1 7", "8", "4", "14 5", "3", "8 11", "10", "0 11", "13 14", "11", "1", "8 5", "0", "13", "2 6", "6", "11", "8", "1 0", "3", "0", "1 13", "0 10", "5", "12", "0 1", "8", "14", "4", "10", "1 7", "3", "3 1", "7 10", "1 6", "14", "0", "6 2", "2", "11 10", "0", "4 11", "14 1", "7", "11 12", "4 0", "7 11", "6 14", "14", "0", "10 4", "1", "7", "6 12", "8 11", "5 8", "0 4", "7 8", "8", "0", "14 1", "11", "12 10", "5", "0 5", "0 8", "2", "0 4", "13 7", "12", "10 11", "13 8", "5", "8", "5", "10", "13", "2 13", "9", "3", "5", "5", "13", "14 6", "3 1", "14", "10", "11", "1 6", "8", "10 1", "5", "14", "9 2", "0", "1", "9 13", "2", "9"]]

translate(circ1)
translate(circ2)
# print(circ1)

ps1 = CHform(N)
update_circ(ps1, circ1)
ps2 = CHform(N)
update_circ(ps2, circ2)
conjugateCHf(ps2)

println(ps1)

println(scalPrdt(ps2, ps1))
